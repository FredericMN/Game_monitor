# 游戏动态监控网站 - 开发策划文档 (V0.3)

**文档状态:** 初稿完成 MVP，进入迭代阶段。

**1. 项目愿景与目标**

*   **愿景:** 创建一个专注于游戏市场动态，特别是新游戏上线、测试计划、核心信息的数据平台，旨在为行业内（或对游戏市场高度关注的）用户提供准确、及时、易于浏览的数据服务。
*   **目标 (第一阶段 - MVP):** [已完成 V0.1]
    *   [X] 实现从指定 Excel 文件 (`data/sample_games.xlsx`) 中读取游戏数据。
    *   [X] 通过后端 API (`/api/games`) 将处理后的数据提供给前端。
    *   [X] 在网页前端以清晰、美观的格式展示游戏信息，包括：
        *   [X] 一个"重点关注"区域，展示筛选出的少量关键游戏（卡片形式，目前取前 8 条）。
        *   [X] 一个"全部游戏列表"区域，展示所有游戏数据（表格形式）。
    *   [X] 建立可持续维护和扩展的基础项目结构和代码规范 (前后端分离, Git, 虚拟环境, 启动脚本)。

**2. 目标用户 (初步设想)**

*   游戏行业分析师、市场研究人员。
*   游戏发行商、开发商内部相关团队（如市场、运营、战略部门）。
*   对游戏行业动态有深度关注的媒体或个人。
*   *（此部分可在后续根据业务发展进一步明确）*

**3. 核心功能 (V0.3 及后续迭代关注点)**

*   **数据源管理与维护:**
    *   **当前状态:**
        *   [X] 已建立脚本从多个数据源（TapTap, 16p）采集游戏信息。(`scripts/taptap_selenium.py`, `scripts/16p_selenium.py`)
        *   [~] 建立数据标准化流程，统一不同来源的数据格式 (需要在 `collect_games.py` 中调整以包含版号信息)。
        *   [~] 实现数据自动导出到 Excel 文件供后端使用 (需要在 `collect_games.py` 中确认逻辑)。
        *   [ ] **新增:** 建立脚本 (`scripts/version_matcher.py`) 用于匹配国家新闻出版署 (NPPA) 的游戏版号信息。
    *   **待解决/优化:**
        *   [ ] **整合版号匹配:** 将 `version_matcher.py` 的功能整合进 `collect_games.py`，在收集各来源数据后进行版号匹配。
        *   [ ] **完善数据更新流程:** 设置定时任务，每日或每周自动运行完整的数据采集与处理流程 (TapTap/16p -> 版号匹配 -> Excel)。
        *   [~] **数据校验:** 在 `collect_games.py` 中实现多来源数据的去重和合并 (需要考虑版号信息)。
        *   [ ] **数据库迁移:** (长期考虑) 数据量增大或需要更复杂查询时，考虑将数据迁移到数据库 (如 PostgreSQL, MySQL)。
        *   [-] ~~多数据源支持: 好游快爆暂时移出当前计划。~~
*   **后端 (`backend/`):**
    *   **已完成:**
        *   [X] Flask 基础搭建。
        *   [X] 使用 Pandas 读取 Excel。
        *   [X] 处理 NaN 并提供 `/api/games` JSON 端点 (初步版本，待优化)。
        *   [X] 启用 CORS。
    *   **待开发/优化:**
        *   [ ] **数据加载优化:** 确认后端 `app.py` 能正确加载包含版号信息的新格式 `data/sample_games.xlsx`。
        *   [ ] **"重点关注"逻辑实现:** 在后端 API 中根据 Excel 中的 "是否重点" 列实现筛选逻辑 (或考虑将此逻辑移至 `collect_games.py`)。
        *   [ ] **API 参数化:** (中期考虑) 允许前端通过 API 参数进行筛选、排序、分页 (e.g., `/api/games?status=测试&sort=日期&page=1`)。
        *   [ ] **错误处理与日志:** 完善 API 的错误处理机制和日志记录。
*   **前端 (`frontend/`):**
    *   **已完成:**
        *   [X] HTML 结构 (导航栏, 重点区域, 列表区域)。
        *   [X] CSS 样式 (分离到 `style.css`, 卡片, 表格, 状态标签)。
        *   [X] JavaScript 通过 `fetch` 调用 API 并动态渲染数据。
        *   [X] 解决了 CORS 及 `NaN` 问题。
        *   [X] 基础状态标签样式逻辑。
        *   [X] **主界面视觉和交互优化。**
    *   **待开发/优化:**
        *   [ ] **展示版号信息 (可选):** 如果需要在前端显示版号相关信息，需要调整 JS 和 HTML。
        *   [ ] **基础搜索/筛选:** 在前端添加简单的输入框或下拉菜单，用 JavaScript 实现对**当前已加载数据**的实时筛选 (按游戏名称、状态等)。
        *   [ ] **分页:** (配合后端 API 参数化) 当数据量很大时，实现前端分页显示。
        *   [ ] **用户体验:** 优化加载状态提示，处理空数据情况下的显示。
        *   [ ] **交互细节:** (可选) 点击卡片或表格行跳转到详情页（需要后端支持）。
*   **项目维护:**
    *   **已完成:**
        *   [X] Git 初始化与 GitHub 链接。
        *   [X] 基础目录结构。
        *   [X] `.gitignore` 配置 (忽略 venv, logs)。
        *   [X] 开发环境启动脚本 (`start_dev.sh`, `start_dev.bat`)。
        *   [X] **依赖管理:** 创建 `requirements.txt` 文件，记录后端 Python 依赖。(`pip freeze > requirements.txt`)
    *   **待完成:**
        *   [ ] **README 文件:** 编写 `README.md`，说明项目用途、如何安装和运行。(暂时推迟)

**4. 技术选型 (当前阶段)**

*   **前端:** HTML5, CSS3, JavaScript (原生)
*   **后端:** Python 3.x, Flask, Pandas, Flask-CORS, openpyxl
*   **数据采集:** Python (Selenium, BeautifulSoup, Requests)
*   **数据存储:** Excel 文件 (`.xlsx`)
*   **版本控制:** Git, GitHub
*   **开发环境:** Windows 10, Python 虚拟环境 (venv)

**5. 未来扩展方向 (非 MVP - 同 V0.1，保持关注)**

*   数据源增强 (数据库, API 对接)
*   功能增强 (用户认证, 数据后台, 高级搜索/筛选/排序, 详情页, 可视化, 关注/通知)
*   架构优化 (部署, 任务队列, 缓存, 前端框架)
*   商业化

**6. 开发计划 (下一步)**

*   **优先级 1 (整合版号匹配与数据处理):**
    1.  **修改 `collect_games.py`:**
        *   在从 TapTap 和 16p 获取数据后，调用 `version_matcher.py` 中的 `match_version_numbers_for_games` 函数，为游戏列表批量添加版号信息。
        *   调整 `standardize_game_data` 和 `remove_duplicates` 函数，以正确处理包含版号的新数据结构。
        *   确保 `copy_to_excel_file` 函数能将包含版号信息（如出版单位、运营单位、版号、批准日期等）的完整数据正确写入 `data/sample_games.xlsx`。
*   **优先级 2 (后端适配与验证):**
    1.  **验证后端数据加载:** 确认 `backend/app.py` 能正确读取更新后（包含新版号列）的 Excel 文件，并且 `/api/games` 端点能正常返回数据。可能需要调整 Pandas 读取逻辑。
    2.  **(可选) 实现后端"重点关注"逻辑:** 若未在 `collect_games.py` 中处理，则根据 Excel 数据实现 `/api/featured-games` 或类似功能。
*   **优先级 3 (前端验证):**
    1.  运行前端应用，检查从后端获取的数据是否能正确显示。确认表格或其他展示区域没有因为数据结构变化而出错。
    2.  **(可选) 更新前端展示:** 如果需要在界面上展示版号信息，修改 HTML 和 JavaScript 代码。
*   **优先级 4 (整体流程测试):**
    1.  运行完整的 `scripts/collect_games.py` 脚本（包含 TapTap/16p 采集 -> 版号匹配 -> Excel 输出）。
    2.  运行后端服务 (`backend/app.py`)。
    3.  运行前端应用，检查整个流程的数据流是否通畅，信息展示是否准确。
*   **优先级 5 (后续优化 - 暂缓):**
    1.  ~~自动化数据采集: 设置定时任务，定期运行数据采集脚本。~~
    2.  ~~API 参数化、前端搜索/分页、README、好游快爆数据源等。~~

--- 